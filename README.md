# Vulnerability-Management-with-Nessus

Summery:

I conducted vulnerability assessment on Windows 10 VM through Nessus Essential for any vulnerability and attempted to remediate high critical vulnerability.

Download links:

Windows 10 ISO: https://www.microsoft.com/en-us/software-download/windows10

Nessus Essential: https://www.tenable.com/products/nessus/nessus-essentials

# Installing Nessus Essential

Once Nessus Essential finishes downloading, it will automatically open Nessus Essential on the browser. I directed to the link to initialize and create account:

![Capture](https://user-images.githubusercontent.com/121040101/223201584-7bc5ba26-bd23-471e-9994-53401a4e4ec7.PNG)

After finishing creating the Nessus account, I tested if I can ping Windows 10 VM from my personal desktop.

To ping the VM IP address continually by command: “ping <ip address> -t” from my computer’s command prompt  

The ping result is “request timed out” because of the firewall setting on the VM:

  ![2](https://user-images.githubusercontent.com/121040101/223203630-9634ad38-3fbd-4e85-88e2-9f649288cb86.png)
  
  I will disable firewall on VM to able to ping from the desktop:
  
  ![3](https://user-images.githubusercontent.com/121040101/223203760-f25a078c-26f1-4a0f-990a-122c752410d8.png)
![4](https://user-images.githubusercontent.com/121040101/223203766-c3335bd4-f585-4b23-88b2-d2b3c9dc39c7.png)

  Now, it's able to ping the Windows 10 VM and it is ready for Nessus scan:
  ![5](https://user-images.githubusercontent.com/121040101/223203909-d2b8f3d6-c034-43a0-93e0-efdeaa249fec.png)

# First Nessus scan 

 

Now I am going to scan VM through Nessus. 

Go to “create new scan” 

Select “basic network scan” 

Name: “Windows 10 Single Host” 

Targets: IP address of the VM windows 

Click “save” 
  
  ![6](https://user-images.githubusercontent.com/121040101/223204113-95873cdd-a8c8-4179-9a11-92baf7d1231d.png)

  After saving, I am on “my scan”. Click launch to start scan:
  
  ![7](https://user-images.githubusercontent.com/121040101/223204164-48cf42c4-c065-4cd7-be38-b4aa78138994.png)

  After scan is finished:
  
  ![9](https://user-images.githubusercontent.com/121040101/223204309-9dbb7424-591f-4b3d-bf57-dcd94b722cb8.png)
![10 ](https://user-images.githubusercontent.com/121040101/223204323-3946cae5-cc9e-4054-9833-a6690d69ec32.png)

  There are not many vulnerabilities because I did not provide credentials and was not scanning authenticated scan. 
  The Nessus was not able to authenticate directly to the remote target because I did not provide any credentials for this VM.
  
  Next, I am going to setup VM to be able to accept authenticated scans and then provide some credentials to Nessus and rescan the VM. 
  
  # Accept authenticated scan and provide credentials to Nessus
  
First, enable remote registry because it allows the Nessus scanner to connect to the VM computer’s registry and can scan insecure configurations:  
  
  ![11 startuptype automatic apply start](https://user-images.githubusercontent.com/121040101/223206119-fa710223-5133-4248-aa2b-c94671bd4942.png)

  Next, enable file and printer sharing: 
  
  ![12](https://user-images.githubusercontent.com/121040101/223206142-b3b5aed9-03c1-4e34-afee-b66262ac61c1.png)

  Disable user account control setting, so it will not notify me: 
  
  ![13](https://user-images.githubusercontent.com/121040101/223206164-d10ca633-28ca-44a0-9569-41f9236cefe8.png)

  Add key that allows remote account to connect to the VM computer. 

Go to user registry to add key farther disable user account control for the remote account I am going to use it to connect to the VM during the Nessus scan: 
  
  ![14](https://user-images.githubusercontent.com/121040101/223206654-1ebce80b-2659-422c-8701-67ed77b298e5.png)
![15](https://user-images.githubusercontent.com/121040101/223206662-d31123b8-e445-4d76-b12a-150d713b0559.png)
![16](https://user-images.githubusercontent.com/121040101/223206668-49d38823-4a66-49a2-9bac-9462bc546e78.png)

 Create new “DWORD” called “local account token filter policy” 

And click to set value data to “1”: 
  
  ![17](https://user-images.githubusercontent.com/121040101/223206703-67eecbfc-2b50-4faa-975c-e51dd8da3aec.png)

  Restart the VM:
  ![18](https://user-images.githubusercontent.com/121040101/223206758-0f523fc4-9b07-489f-b185-06f3626ab4b4.png)

  Go back to Nessus 

Select previous scan and click “more” then “configure”:
  
  ![19 nessus select previous scan  slect more and config](https://user-images.githubusercontent.com/121040101/223206799-89d4e2b5-cba1-43c2-8d4e-b9bdd3b470de.png)

  I am going to “credentials” and add set of credentials. 

I’m going to add Windows 10 VM credentials.  

Enter the credentials of the user. Mine username is “admin” and enter the password: 
  
  ![20](https://user-images.githubusercontent.com/121040101/223206831-a01af57d-43bf-4e83-bb77-ef3d9fb2919b.png)

  Go back to scans and launch the scan one more time: 
  
  ![21 scan again](https://user-images.githubusercontent.com/121040101/223206855-114d7bef-3638-4268-8c11-f5be03f8d860.png)

  
  # Nessus scan after authenticated scan and credentials 

Compared to the first scan, there are more vulnerabilities because I enabled credential scanning and configured windows VM to accept remote scan: 

Before: 
  ![10 ](https://user-images.githubusercontent.com/121040101/223206917-a3ee0709-e72f-4687-8232-91b195a8d148.png)
After:
  ![22](https://user-images.githubusercontent.com/121040101/223206957-5bf0876e-242b-407d-8614-79450bca25f5.png)

  # Detail of the vulnerabilities 

In the “VPR top threats” tab, tells me what to prioritize to remediate: 
  
  ![23](https://user-images.githubusercontent.com/121040101/223207145-2a4be027-68e0-4798-a19c-947be7ce601a.png)

  Looking at the report, most of these vulnerabilities can be remediated through windows update. 

If you want a more detailed description of specific vulnerabilities, I can click it and view description, solutions, and output. 

Here is example of Microsoft internet explorer unsupported version detection:
  
  ![25](https://user-images.githubusercontent.com/121040101/223207199-6599682e-65be-40bc-8a7a-28b448a10842.png)

  
  # Remediate the vulnerabilities 

 

Here is my attempt to remediate most of the vulnerabilities. 

I will update the windows with the latest update:
  
  ![update2](https://user-images.githubusercontent.com/121040101/223207243-843d6bde-12fe-4ac8-945d-885bb2f275c0.png)

  Rescan the VM on Nessus 

Result: 
  
![27](https://user-images.githubusercontent.com/121040101/223207317-1f7a48f7-819d-4f2c-a950-2bc175b95e20.png)
![30](https://user-images.githubusercontent.com/121040101/223207412-c0f78dec-1279-4ac8-8c46-88b558125e7f.png)

  The only major vulnerability is Microsoft internet explorer.  

In the organizational environment, I would want to automate updates to make sure security is up to date. 
  
  This concludes the lab.
